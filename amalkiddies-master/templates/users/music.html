{% extends 'users/basic.html' %}
{% block content %}
<!-- Sidebar Navigation -->
<div class="d-flex">
  <nav class="sidebar bg-dark text-white p-4" style="min-width:220px; height:100vh; position:sticky; top:0;">
    <h3 class="mb-4" style="font-weight:700; color:#1db954;">Music Hub</h3>
    <ul class="nav flex-column">
      <li class="nav-item mb-2"><a class="nav-link text-white" href="#"><i class="fas fa-home mr-2"></i>Home</a></li>
      <li class="nav-item mb-2"><a class="nav-link text-white" href="#"><i class="fas fa-search mr-2"></i>Search</a></li>
      <li class="nav-item mb-2"><a class="nav-link text-white" href="#"><i class="fas fa-book mr-2"></i>Your Library</a></li>
      <li class="nav-item mb-2"><a class="nav-link text-white" href="#"><i class="fas fa-plus mr-2"></i>Create Playlist</a></li>
      <li class="nav-item mb-2"><a class="nav-link text-white" href="#"><i class="fas fa-heart mr-2"></i>Liked Songs</a></li>
      <li class="nav-item mb-2"><a class="nav-link text-white" href="/users/music/upload/"><i class="fas fa-upload mr-2"></i>Upload Music</a></li>
      <li class="nav-item mt-4"><a class="nav-link text-white" href="#"><i class="fas fa-user mr-2"></i>Profile</a></li>
    </ul>
  </nav>
  <div class="container py-5">
    <!-- Personalized Greeting + Search Bar -->
    <div class="row mb-4">
      <div class="col-12 d-flex justify-content-between align-items-center">
        <div class="d-flex align-items-center">
          <img src="https://randomuser.me/api/portraits/men/32.jpg" alt="User Profile" class="rounded-circle mr-2" style="width:48px; height:48px; border:2px solid #1db954;">
          <span class="font-weight-bold ml-2">Good morning, Username</span>
        </div>
        <!-- Move YouTube search bar here -->
        <form method="get" action="{% url 'music_lounge' %}" class="flex-grow-1 mx-4" style="max-width:400px;">
          <div class="input-group">
            <input type="text" name="query" class="form-control" placeholder="Search for songs on YouTube" required>
            <div class="input-group-append">
              <button class="btn btn-success" type="submit">Search</button>
            </div>
          </div>
        </form>
        <button class="btn btn-warning">Go Premium</button>
      </div>
    </div>
    {% if videos %}
      <script src="https://www.youtube.com/iframe_api"></script>
      <script>
        var ytVideoIdsStr = "{% for video in videos %}{{ video.id }}{% if not forloop.last %},{% endif %}{% endfor %}";
        var ytVideoIds = ytVideoIdsStr ? ytVideoIdsStr.split(',') : [];
        var ytPlayers = {};
        function onYouTubeIframeAPIReady() {
          ytVideoIds.forEach(function(videoId) {
            ytPlayers[videoId] = new YT.Player('player-' + videoId, {
              height: '60', width: '320', videoId: videoId,
              playerVars: { 'controls': 0, 'autoplay': 0, 'modestbranding': 1, 'rel': 0, 'showinfo': 0 },
              events: {
                'onReady': function(e) { updateYTDuration(videoId); },
                'onStateChange': function(e) { if(e.data==1) trackYTProgress(videoId); }
              }
            });
          });
        }
        function playYT(id) { ytPlayers[id].playVideo(); }
        function pauseYT(id) { ytPlayers[id].pauseVideo(); }
        function stopYT(id) { ytPlayers[id].stopVideo(); document.getElementById('progress-'+id).value=0; document.getElementById('current-'+id).textContent='0:00'; }
        function setYTVolume(slider, id) { ytPlayers[id].setVolume(slider.value); }
        function seekYT(slider, id) { ytPlayers[id].seekTo(slider.value, true); }
        function updateYTDuration(id) {
          var duration = ytPlayers[id].getDuration();
          document.getElementById('duration-'+id).textContent = Math.floor(duration/60)+":"+(Math.floor(duration)%60).toString().padStart(2,'0');
          document.getElementById('progress-'+id).max = Math.floor(duration);
        }
        function trackYTProgress(id) {
          var interval = setInterval(function() {
            var player = ytPlayers[id];
            if(player.getPlayerState()!==1) { clearInterval(interval); return; }
            var time = player.getCurrentTime();
            document.getElementById('current-'+id).textContent = Math.floor(time/60)+":"+(Math.floor(time)%60).toString().padStart(2,'0');
            document.getElementById('progress-'+id).value = Math.floor(time);
          }, 1000);
        }
      </script>
      <div class="row mb-5">
        <div class="col-12">
          <h4 class="mb-3" style="font-weight:700; color:#1db954; letter-spacing:1px;">YouTube Search Results</h4>
        </div>
        <div class="youtube-results">
      {% for video in videos %}
        <div class="card youtube-card shadow-sm bg-dark text-white" style="width: 340px; border-radius: 16px; margin-bottom: 20px; position: relative; flex: 0 0 auto;" id="yt-card-{{ video.id }}">
          <div class="card-body d-flex flex-column align-items-center">
            <h5>{{ video.title }}</h5>
            <div class="yt-controls">
              <button onclick="playYT('{{ video.id }}')" class="btn btn-success">Play</button>
              <button onclick="pauseYT('{{ video.id }}')" class="btn btn-secondary">Pause</button>
              <button onclick="stopYT('{{ video.id }}')" class="btn btn-danger">Stop</button>
              <input type="range" min="0" max="100" value="100" class="volume-slider" style="width:80px;" onchange="setYTVolume(this, '{{ video.id }}')">
            </div>
            <div class="yt-timing">
              <span id="current-{{ video.id }}" style="font-size:12px;">0:00</span>
              <input type="range" min="0" max="100" value="0" id="progress-{{ video.id }}" style="flex:1;" onchange="seekYT(this, '{{ video.id }}')">
              <span id="duration-{{ video.id }}" style="font-size:12px;">0:00</span>
            </div>
            <div id="player-{{ video.id }}" class="yt-player"></div>
          </div>
        </div>
      {% endfor %}
    </div>
      </div>
    {% endif %}
    {% if videos is not None and videos|length == 0 %}
      <div class="alert alert-warning text-center" style="margin-bottom:24px;">Music search is temporarily unavailable due to YouTube API limits. Please try again later.</div>
    {% endif %}
    <!-- User Uploaded Music Section -->
    <div class="row mb-5">
      <div class="col-12">
        <h4 class="mb-3" style="font-weight:700; color:#43a047; letter-spacing:1px;">Your Uploaded Music</h4>
      </div>
      <div class="card-list">
        {% for track in user_tracks %}
          <div class="music-card">
            {% if track.cover_image %}
              <img src="{{ track.cover_image.url }}" alt="Cover">
            {% endif %}
            <div class="music-info">
              <h5>{{ track.title }}</h5>
              <p>{{ track.artist }}{% if track.album %} | {{ track.album }}{% endif %}{% if track.genre %} | {{ track.genre }}{% endif %}</p>
            </div>
            <audio controls src="{{ track.audio_file.url }}" style="width:100%"></audio>
            <p class="text-muted" style="font-size:12px;">Uploaded: {{ track.uploaded_at }}</p>
          </div>
        {% empty %}
          <p class="ml-3">No music uploaded yet. <a href="/users/music/upload/">Upload now</a>.</p>
        {% endfor %}
      </div>
    </div>
    <!-- Promotional Banner -->
    <div class="row mb-4">
      <div class="col-12">
        <div class="alert alert-success text-center" style="font-size:1.2rem; font-weight:600; background:#1db954; color:#fff; border-radius:16px;">
          <i class="fas fa-star mr-2"></i> Get 3 months of Premium for free! <button class="btn btn-light ml-3">Upgrade Now</button>
        </div>
      </div>
    </div>
    <!-- Top Trending Songs Section -->
    <div class="row mb-5">
      <div class="col-12">
        <h4 class="mb-3" style="font-weight:700; color:#1db954; letter-spacing:1px;">Top Trending Songs</h4>
      </div>
      <div class="youtube-results" style="margin-bottom:24px;">
        {% for song in trending_songs %}
          {% if song.id and song.title and song.thumbnail %}
            <div class="card youtube-card shadow-sm bg-dark text-white" style="width: 340px; border-radius: 16px; margin-bottom: 20px; position: relative; flex: 0 0 auto;" id="yt-card-{{ song.id }}">
              <div class="card-body d-flex flex-column align-items-center">
                <img src="{{ song.thumbnail }}" alt="Trending Song Cover" style="width:72px;height:72px;border-radius:8px;object-fit:cover;margin-bottom:8px;">
                <h5>{{ song.title }}</h5>
                <div class="yt-controls">
                  <button onclick="playYT('{{ song.id }}')" class="btn btn-success">Play</button>
                  <button onclick="pauseYT('{{ song.id }}')" class="btn btn-secondary">Pause</button>
                  <button onclick="stopYT('{{ song.id }}')" class="btn btn-danger">Stop</button>
                  <input type="range" min="0" max="100" value="100" class="volume-slider" style="width:80px;" onchange="setYTVolume(this, '{{ song.id }}')">
                </div>
                <div class="yt-timing">
                  <span id="current-{{ song.id }}" style="font-size:12px;">0:00</span>
                  <input type="range" min="0" max="100" value="0" id="progress-{{ song.id }}" style="flex:1;" onchange="seekYT(this, '{{ song.id }}')">
                  <span id="duration-{{ song.id }}" style="font-size:12px;">0:00</span>
                </div>
                <div id="player-{{ song.id }}" class="yt-player"></div>
              </div>
            </div>
          {% endif %}
        {% empty %}
          <p class="ml-3">No trending songs found.</p>
        {% endfor %}
      </div>
    </div>
    <script>
      // Add trending song IDs to YouTube player initialization
      var trendingVideoIdsStr = "{% for song in trending_songs %}{{ song.id }}{% if not forloop.last %},{% endif %}{% endfor %}";
      var trendingVideoIds = trendingVideoIdsStr ? trendingVideoIdsStr.split(',') : [];
      if (typeof ytVideoIds !== 'undefined') {
        ytVideoIds = ytVideoIds.concat(trendingVideoIds);
      } else {
        ytVideoIds = trendingVideoIds;
      }
    </script>
    <!-- Genres & Moods Section -->
    <div class="row mb-5">
      <div class="col-12">
        <h4 class="mb-3" style="font-weight:700; color:#ff8c40; letter-spacing:1px;">Genres & Moods</h4>
      </div>
      <div id="genresSlider" class="d-flex justify-content-start" style="overflow-x:auto;overflow-y:hidden;gap:16px;padding:8px 0;scroll-behavior:smooth;max-width:900px;cursor:grab;">
        <span class="genre-chip">Pop</span>
        <span class="genre-chip">Rock</span>
        <span class="genre-chip">Hip-Hop</span>
        <span class="genre-chip">Chill</span>
        <span class="genre-chip">Workout</span>
        <span class="genre-chip">Party</span>
        <span class="genre-chip">Jazz</span>
        <span class="genre-chip">Classical</span>
        <span class="genre-chip">EDM</span>
        <span class="genre-chip">Indie</span>
        <span class="genre-chip">Country</span>
      </div>
      <script>
        // Drag-to-scroll for Genres Slider
        const genresSlider = document.getElementById('genresSlider');
        let isDownGenres = false;
        let startXGenres;
        let scrollLeftGenres;
        genresSlider.addEventListener('mousedown', (e) => {
          isDownGenres = true;
          genresSlider.classList.add('active');
          startXGenres = e.pageX - genresSlider.offsetLeft;
          scrollLeftGenres = genresSlider.scrollLeft;
        });
        genresSlider.addEventListener('mouseleave', () => {
          isDownGenres = false;
          genresSlider.classList.remove('active');
        });
        genresSlider.addEventListener('mouseup', () => {
          isDownGenres = false;
          genresSlider.classList.remove('active');
        });
        genresSlider.addEventListener('mousemove', (e) => {
          if (!isDownGenres) return;
          e.preventDefault();
          const x = e.pageX - genresSlider.offsetLeft;
          const walk = (x - startXGenres) * 1.5;
          genresSlider.scrollLeft = scrollLeftGenres - walk;
        });
        genresSlider.addEventListener('touchstart', (e) => {
          isDownGenres = true;
          startXGenres = e.touches[0].pageX - genresSlider.offsetLeft;
          scrollLeftGenres = genresSlider.scrollLeft;
        });
        genresSlider.addEventListener('touchend', () => {
          isDownGenres = false;
        });
        genresSlider.addEventListener('touchmove', (e) => {
          if (!isDownGenres) return;
          const x = e.touches[0].pageX - genresSlider.offsetLeft;
          const walk = (x - startXGenres) * 1.5;
          genresSlider.scrollLeft = scrollLeftGenres - walk;
        });
      </script>
    </div>
    <!-- Featured Playlists Section -->
    <div class="row mb-5">
      <div class="col-12">
        <h4 class="mb-3" style="font-weight:700; color:#1db954; letter-spacing:1px;">Featured Playlists</h4>
      </div>
      <div id="playlistsSlider" class="d-flex justify-content-start" style="overflow-x:auto;overflow-y:hidden;gap:24px;padding:8px 0;scroll-behavior:smooth;max-width:900px;cursor:grab;">
        <div class="playlist-card" style="min-width:220px;flex:0 0 auto;">
          <img src="https://images.unsplash.com/photo-1465101046530-73398c7f28ca" alt="Playlist Cover">
          <div class="playlist-info">
            <h5>Top Hits</h5>
            <p>By MusicHub</p>
          </div>
          <button class="play-btn">▶</button>
        </div>
        <div class="playlist-card" style="min-width:220px;flex:0 0 auto;">
          <img src="https://images.unsplash.com/photo-1511671782779-c97d3d27a1d4" alt="Playlist Cover">
          <div class="playlist-info">
            <h5>Chill Vibes</h5>
            <p>By DJ Relax</p>
          </div>
          <button class="play-btn">▶</button>
        </div>
        <div class="playlist-card" style="min-width:220px;flex:0 0 auto;">
          <img src="https://images.unsplash.com/photo-1506744038136-46273834b3fb" alt="Playlist Cover">
          <div class="playlist-info">
            <h5>Workout Mix</h5>
            <p>By FitBeats</p>
          </div>
          <button class="play-btn">▶</button>
        </div>
        <div class="playlist-card" style="min-width:220px;flex:0 0 auto;">
          <img src="https://images.unsplash.com/photo-1465101178521-c1a6f3b5b2c1" alt="Playlist Cover">
          <div class="playlist-info">
            <h5>Jazz Nights</h5>
            <p>By SmoothJazz</p>
          </div>
          <button class="play-btn">▶</button>
        </div>
      </div>
      <script>
        // Drag-to-scroll for Playlists Slider
        const playlistsSlider = document.getElementById('playlistsSlider');
        let isDownPlaylists = false;
        let startXPlaylists;
        let scrollLeftPlaylists;
        playlistsSlider.addEventListener('mousedown', (e) => {
          isDownPlaylists = true;
          playlistsSlider.classList.add('active');
          startXPlaylists = e.pageX - playlistsSlider.offsetLeft;
          scrollLeftPlaylists = playlistsSlider.scrollLeft;
        });
        playlistsSlider.addEventListener('mouseleave', () => {
          isDownPlaylists = false;
          playlistsSlider.classList.remove('active');
        });
        playlistsSlider.addEventListener('mouseup', () => {
          isDownPlaylists = false;
          playlistsSlider.classList.remove('active');
        });
        playlistsSlider.addEventListener('mousemove', (e) => {
          if (!isDownPlaylists) return;
          e.preventDefault();
          const x = e.pageX - playlistsSlider.offsetLeft;
          const walk = (x - startXPlaylists) * 1.5;
          playlistsSlider.scrollLeft = scrollLeftPlaylists - walk;
        });
        playlistsSlider.addEventListener('touchstart', (e) => {
          isDownPlaylists = true;
          startXPlaylists = e.touches[0].pageX - playlistsSlider.offsetLeft;
          scrollLeftPlaylists = playlistsSlider.scrollLeft;
        });
        playlistsSlider.addEventListener('touchend', () => {
          isDownPlaylists = false;
        });
        playlistsSlider.addEventListener('touchmove', (e) => {
          if (!isDownPlaylists) return;
          const x = e.touches[0].pageX - playlistsSlider.offsetLeft;
          const walk = (x - startXPlaylists) * 1.5;
          playlistsSlider.scrollLeft = scrollLeftPlaylists - walk;
        });
      </script>
    </div>
    <!-- Albums Section -->
    <div class="row mb-5">
      <div class="col-12">
        <h4 class="mb-3" style="font-weight:700; color:#43a047; letter-spacing:1px;">Albums</h4>
      </div>
      <div id="albumsSlider" class="d-flex justify-content-start" style="overflow-x:auto;overflow-y:hidden;gap:24px;padding:8px 0;scroll-behavior:smooth;max-width:900px;cursor:grab;">
        <div class="album-card" style="min-width:220px;flex:0 0 auto;">
          <img src="https://images.unsplash.com/photo-1511671782779-c97d3d27a1d4" alt="Album Cover">
          <div class="album-info">
            <h5>Album Title</h5>
            <p>Artist Name</p>
          </div>
        </div>
        <div class="album-card" style="min-width:220px;flex:0 0 auto;">
          <img src="https://images.unsplash.com/photo-1465101046530-73398c7f28ca" alt="Album Cover">
          <div class="album-info">
            <h5>Album Title 2</h5>
            <p>Artist Name</p>
          </div>
        </div>
        <div class="album-card" style="min-width:220px;flex:0 0 auto;">
          <img src="https://images.unsplash.com/photo-1506744038136-46273834b3fb" alt="Album Cover">
          <div class="album-info">
            <h5>Album Title 3</h5>
            <p>Artist Name</p>
          </div>
        </div>
      </div>
      <script>
        // Drag-to-scroll for Albums Slider
        const albumsSlider = document.getElementById('albumsSlider');
        let isDownAlbums = false;
        let startXAlbums;
        let scrollLeftAlbums;
        albumsSlider.addEventListener('mousedown', (e) => {
          isDownAlbums = true;
          albumsSlider.classList.add('active');
          startXAlbums = e.pageX - albumsSlider.offsetLeft;
          scrollLeftAlbums = albumsSlider.scrollLeft;
        });
        albumsSlider.addEventListener('mouseleave', () => {
          isDownAlbums = false;
          albumsSlider.classList.remove('active');
        });
        albumsSlider.addEventListener('mouseup', () => {
          isDownAlbums = false;
          albumsSlider.classList.remove('active');
        });
        albumsSlider.addEventListener('mousemove', (e) => {
          if (!isDownAlbums) return;
          e.preventDefault();
          const x = e.pageX - albumsSlider.offsetLeft;
          const walk = (x - startXAlbums) * 1.5;
          albumsSlider.scrollLeft = scrollLeftAlbums - walk;
        });
        albumsSlider.addEventListener('touchstart', (e) => {
          isDownAlbums = true;
          startXAlbums = e.touches[0].pageX - albumsSlider.offsetLeft;
          scrollLeftAlbums = albumsSlider.scrollLeft;
        });
        albumsSlider.addEventListener('touchend', () => {
          isDownAlbums = false;
        });
        albumsSlider.addEventListener('touchmove', (e) => {
          if (!isDownAlbums) return;
          const x = e.touches[0].pageX - albumsSlider.offsetLeft;
          const walk = (x - startXAlbums) * 1.5;
          albumsSlider.scrollLeft = scrollLeftAlbums - walk;
        });
      </script>
    </div>
    <!-- Podcasts Section -->
    <div class="row mb-5">
      <div class="col-12">
        <h4 class="mb-3" style="font-weight:700; color:#5e35b1; letter-spacing:1px;">Podcasts</h4>
      </div>
      <div id="podcastsSlider" class="d-flex justify-content-start" style="overflow-x:auto;overflow-y:hidden;gap:24px;padding:8px 0;scroll-behavior:smooth;max-width:900px;cursor:grab;">
        <div class="podcast-card" style="min-width:220px;flex:0 0 auto;">
          <img src="https://images.unsplash.com/photo-1465101046530-73398c7f28ca" alt="Podcast Cover">
          <div class="podcast-info">
            <h5>Podcast Title</h5>
            <p>Host Name</p>
          </div>
          <button class="subscribe-btn">Subscribe</button>
        </div>
        <div class="podcast-card" style="min-width:220px;flex:0 0 auto;">
          <img src="https://images.unsplash.com/photo-1511671782779-c97d3d27a1d4" alt="Podcast Cover">
          <div class="podcast-info">
            <h5>Podcast Title 2</h5>
            <p>Host Name</p>
          </div>
          <button class="subscribe-btn">Subscribe</button>
        </div>
        <div class="podcast-card" style="min-width:220px;flex:0 0 auto;">
          <img src="https://images.unsplash.com/photo-1506744038136-46273834b3fb" alt="Podcast Cover">
          <div class="podcast-info">
            <h5>Podcast Title 3</h5>
            <p>Host Name</p>
          </div>
          <button class="subscribe-btn">Subscribe</button>
        </div>
      </div>
      <script>
        // Drag-to-scroll for Podcasts Slider
        const podcastsSlider = document.getElementById('podcastsSlider');
        let isDownPodcasts = false;
        let startXPodcasts;
        let scrollLeftPodcasts;
        podcastsSlider.addEventListener('mousedown', (e) => {
          isDownPodcasts = true;
          podcastsSlider.classList.add('active');
          startXPodcasts = e.pageX - podcastsSlider.offsetLeft;
          scrollLeftPodcasts = podcastsSlider.scrollLeft;
        });
        podcastsSlider.addEventListener('mouseleave', () => {
          isDownPodcasts = false;
          podcastsSlider.classList.remove('active');
        });
        podcastsSlider.addEventListener('mouseup', () => {
          isDownPodcasts = false;
          podcastsSlider.classList.remove('active');
        });
        podcastsSlider.addEventListener('mousemove', (e) => {
          if (!isDownPodcasts) return;
          e.preventDefault();
          const x = e.pageX - podcastsSlider.offsetLeft;
          const walk = (x - startXPodcasts) * 1.5;
          podcastsSlider.scrollLeft = scrollLeftPodcasts - walk;
        });
        podcastsSlider.addEventListener('touchstart', (e) => {
          isDownPodcasts = true;
          startXPodcasts = e.touches[0].pageX - podcastsSlider.offsetLeft;
          scrollLeftPodcasts = podcastsSlider.scrollLeft;
        });
        podcastsSlider.addEventListener('touchend', () => {
          isDownPodcasts = false;
        });
        podcastsSlider.addEventListener('touchmove', (e) => {
          if (!isDownPodcasts) return;
          const x = e.touches[0].pageX - podcastsSlider.offsetLeft;
          const walk = (x - startXPodcasts) * 1.5;
          podcastsSlider.scrollLeft = scrollLeftPodcasts - walk;
        });
      </script>
    </div>
    <!-- Favorites Section -->
    <div class="row mb-5">
      <div class="col-12">
        <h4 class="mb-3" style="font-weight:700; color:#ffd700; letter-spacing:1px;">My Favorites</h4>
      </div>
      <div id="favoritesSlider" class="d-flex justify-content-start" style="overflow-x:auto;overflow-y:hidden;gap:24px;padding:8px 0;scroll-behavior:smooth;max-width:900px;cursor:grab;">
        <div class="music-card favorite" style="min-width:220px;flex:0 0 auto;">
          <img src="https://images.unsplash.com/photo-1511671782779-c97d3d27a1d4" alt="Track Cover">
          <div class="music-info">
            <h5>Favorite Track</h5>
            <p>Artist Name</p>
          </div>
          <button class="play-btn">▶</button>
          <button class="remove-fav-btn">🗑️</button>
        </div>
        <div class="music-card favorite" style="min-width:220px;flex:0 0 auto;">
          <img src="https://images.unsplash.com/photo-1465101046530-73398c7f28ca" alt="Track Cover">
          <div class="music-info">
            <h5>Favorite Track 2</h5>
            <p>Artist Name</p>
          </div>
          <button class="play-btn">▶</button>
          <button class="remove-fav-btn">🗑️</button>
        </div>
        <div class="music-card favorite" style="min-width:220px;flex:0 0 auto;">
          <img src="https://images.unsplash.com/photo-1506744038136-46273834b3fb" alt="Track Cover">
          <div class="music-info">
            <h5>Favorite Track 3</h5>
            <p>Artist Name</p>
          </div>
          <button class="play-btn">▶</button>
          <button class="remove-fav-btn">🗑️</button>
        </div>
      </div>
      <script>
        // Drag-to-scroll for Favorites Slider
        const favoritesSlider = document.getElementById('favoritesSlider');
        let isDownFavorites = false;
        let startXFavorites;
        let scrollLeftFavorites;
        favoritesSlider.addEventListener('mousedown', (e) => {
          isDownFavorites = true;
          favoritesSlider.classList.add('active');
          startXFavorites = e.pageX - favoritesSlider.offsetLeft;
          scrollLeftFavorites = favoritesSlider.scrollLeft;
        });
        favoritesSlider.addEventListener('mouseleave', () => {
          isDownFavorites = false;
          favoritesSlider.classList.remove('active');
        });
        favoritesSlider.addEventListener('mouseup', () => {
          isDownFavorites = false;
          favoritesSlider.classList.remove('active');
        });
        favoritesSlider.addEventListener('mousemove', (e) => {
          if (!isDownFavorites) return;
          e.preventDefault();
          const x = e.pageX - favoritesSlider.offsetLeft;
          const walk = (x - startXFavorites) * 1.5;
          favoritesSlider.scrollLeft = scrollLeftFavorites - walk;
        });
        favoritesSlider.addEventListener('touchstart', (e) => {
          isDownFavorites = true;
          startXFavorites = e.touches[0].pageX - favoritesSlider.offsetLeft;
          scrollLeftFavorites = favoritesSlider.scrollLeft;
        });
        favoritesSlider.addEventListener('touchend', () => {
          isDownFavorites = false;
        });
        favoritesSlider.addEventListener('touchmove', (e) => {
          if (!isDownFavorites) return;
          const x = e.touches[0].pageX - favoritesSlider.offsetLeft;
          const walk = (x - startXFavorites) * 1.5;
          favoritesSlider.scrollLeft = scrollLeftFavorites - walk;
        });
      </script>
    </div>
    <!-- Playlist Creation -->
    <div class="row mb-5">
      <div class="col-12">
        <h4 class="mb-3" style="font-weight:700; color:#1db954; letter-spacing:1px;">Create Playlist</h4>
      </div>
      <input type="text" class="form-control mb-2" placeholder="Playlist Name">
      <button class="btn btn-success">Create</button>
    </div>

  <!-- Comments/Reviews -->
  <div class="row mb-5">
    <div class="col-12">
      <h4 class="mb-3" style="font-weight:700; color:#2d9cdb; letter-spacing:1px;">Comments & Reviews</h4>
    </div>
    <div class="comments-list">
      <div class="comment">
        <strong>User1:</strong> Love this track!
      </div>
      <div class="comment">
        <strong>User2:</strong> Amazing playlist!
      </div>
      <!-- ...more comments... -->
    </div>
    <input type="text" class="form-control mb-2" placeholder="Add a comment...">
    <button class="btn btn-info">Post</button>
  </div>

  <!-- Social Sharing -->
  <div class="row mb-5">
    <div class="col-12">
      <h4 class="mb-3" style="font-weight:700; color:#ff4066; letter-spacing:1px;">Share</h4>
    </div>
    <button class="btn btn-primary mr-2">Share on Facebook</button>
    <button class="btn btn-info mr-2">Share on Twitter</button>
    <button class="btn btn-danger">Share on Instagram</button>
  </div>

  <!-- Premium Features -->
  <div class="row mb-5">
    <div class="col-12">
      <h4 class="mb-3" style="font-weight:700; color:#ffd700; letter-spacing:1px;">Premium Features</h4>
    </div>
    <ul>
      <li>Ad-free listening</li>
      <li>Offline downloads</li>
      <li>High quality audio</li>
    </ul>
    <button class="btn btn-warning">Upgrade Now</button>
  </div>

  <!-- Lyrics Display -->
  <div class="row mb-5">
    <div class="col-12">
      <h4 class="mb-3" style="font-weight:700; color:#43a047; letter-spacing:1px;">Lyrics</h4>
    </div>
    <div class="lyrics-box">
      <p>Sample lyrics for the currently playing track...</p>
    </div>
  </div>

  <!-- Recently Played -->
  <div class="row mb-5">
    <div class="col-12">
      <h4 class="mb-3" style="font-weight:700; color:#1db954; letter-spacing:1px;">Recently Played</h4>
    </div>
    <div class="card-list">
      <div class="music-card recent">
        <img src="https://images.unsplash.com/photo-1465101046530-73398c7f28ca" alt="Track Cover">
        <div class="music-info">
          <h5>Recent Track</h5>
          <p>Artist Name</p>
        </div>
        <button class="play-btn">▶</button>
      </div>
      <!-- ...more recent cards... -->
    </div>
  </div>

  <div class="row">
    <div class="col-12">
      <h2 class="mb-4 text-center" style="font-weight:800; color:#2d9cdb; letter-spacing:2px; text-shadow:0 2px 12px #2d9cdb33;"><i class="fas fa-music"></i> Music Hub</h2>
    </div>
  </div>
  <!-- Footer -->
  <footer class="mt-5 pt-4 pb-2 text-center text-white" style="background:#222; border-radius:16px;">
    <div class="mb-2">
      <a href="#" class="text-white mx-2">About</a> |
      <a href="#" class="text-white mx-2">Help</a> |
      <a href="#" class="text-white mx-2">Terms</a> |
      <a href="#" class="text-white mx-2">Privacy</a>
    </div>
    <div class="mb-2">
      <a href="#" class="text-white mx-2"><i class="fab fa-facebook"></i></a>
      <a href="#" class="text-white mx-2"><i class="fab fa-twitter"></i></a>
      <a href="#" class="text-white mx-2"><i class="fab fa-instagram"></i></a>
    </div>
    <div style="font-size:13px;">&copy; 2025 Music Hub. All rights reserved.</div>
  </footer>
  </div>
</div>
  <style>
    body {
      background: #181818;
      color: #fff;
      font-family: 'Segoe UI', Arial, sans-serif;
      margin: 0;
      padding: 0;
    }
    .music-container {
      max-width: 1200px;
      margin: 40px auto 0 auto;
      background: #222;
      border-radius: 16px;
      box-shadow: 0 4px 32px rgba(0,0,0,0.4);
      padding: 32px 24px 120px 24px;
      position: relative;
    }
    .card-list {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 24px;
      margin: 24px 0;
    }
    .music-card, .playlist-card, .album-card, .podcast-card {
      background: #282828;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
      padding: 16px;
      display: flex;
      flex-direction: column;
      align-items: center;
      transition: transform 0.2s;
    }
    .music-card img, .playlist-card img, .album-card img, .podcast-card img {
      width: 72px;
      height: 72px;
      border-radius: 8px;
      object-fit: cover;
      margin-bottom: 8px;
    }
    .music-info, .playlist-info, .album-info, .podcast-info {
      text-align: center;
    }
    .play-btn, .pause-btn, .mute-btn, .download-btn, .edit-btn, .share-btn, .remove-fav-btn, .remove-queue-btn, .create-playlist-btn, .subscribe-btn, .unfollow-btn, .upgrade-btn, .queue-btn, .shuffle-btn, .repeat-btn {
      background: #1db954;
      color: #fff;
      border: none;
      border-radius: 20px;
      padding: 6px 14px;
      margin: 6px 2px;
      cursor: pointer;
      font-size: 16px;
      transition: background 0.2s;
    }
    .play-btn:hover, .pause-btn:hover, .mute-btn:hover, .download-btn:hover, .edit-btn:hover, .share-btn:hover, .remove-fav-btn:hover, .remove-queue-btn:hover, .create-playlist-btn:hover, .subscribe-btn:hover, .unfollow-btn:hover, .upgrade-btn:hover, .queue-btn:hover, .shuffle-btn:hover, .repeat-btn:hover {
      background: #14833b;
    }
    .genre-list, .artist-list {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin: 12px 0;
    }
    .genre-chip, .artist-chip {
      background: #333;
      color: #fff;
      border-radius: 16px;
      padding: 6px 16px;
      font-size: 14px;
      cursor: pointer;
      border: 1px solid #444;
    }
    .genre-chip:hover, .artist-chip:hover {
      background: #1db954;
      color: #fff;
    }
    .queue-list {
      list-style: none;
      padding: 0;
      margin: 0 0 12px 0;
    }
    .queue-list li {
      background: #282828;
      border-radius: 8px;
      margin-bottom: 8px;
      padding: 8px 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .device {
      font-size: 12px;
      color: #1db954;
      margin-left: 8px;
    }
    .queue-controls {
      display: flex;
      gap: 12px;
      margin-top: 8px;
    }
    .lyrics-section {
      background: #282828;
      border-radius: 12px;
      padding: 16px;
      margin: 24px 0;
    }
    .lyrics-box {
      color: #fff;
      font-size: 16px;
      line-height: 1.6;
    }
    .comments-section {
      background: #282828;
      border-radius: 12px;
      padding: 16px;
      margin: 24px 0;
    }
    .comments-list {
      margin-bottom: 12px;
    }
    .comment {
      background: #333;
      border-radius: 8px;
      padding: 8px 12px;
      margin-bottom: 6px;
    }
    .add-comment-btn {
      background: #1db954;
      color: #fff;
      border: none;
      border-radius: 20px;
      padding: 6px 14px;
      cursor: pointer;
    }
    .activity-feed-section {
      background: #282828;
      border-radius: 12px;
      padding: 16px;
      margin: 24px 0;
    }
    .activity-list {
      margin-top: 8px;
    }
    .activity-item {
      background: #333;
      border-radius: 8px;
      padding: 8px 12px;
      margin-bottom: 6px;
    }
    .premium-section {
      background: #282828;
      border-radius: 12px;
      padding: 16px;
      margin: 24px 0;
    }
    .premium-section ul {
      list-style: none;
      padding: 0;
    }
    .premium-section li {
      margin-bottom: 8px;
    }
    .mini-player.sticky {
      position: fixed;
      left: 0;
      bottom: 0;
      width: 100vw;
      background: #181818;
      box-shadow: 0 -2px 16px rgba(0,0,0,0.6);
      display: flex;
      align-items: center;
      padding: 12px 32px;
      z-index: 100;
    }
    .mini-player img {
      width: 56px;
      height: 56px;
      border-radius: 8px;
      margin-right: 16px;
    }
    .player-info {
      flex: 1;
      min-width: 0;
    }
    .youtube-results {
      display: flex;
      flex-direction: row;
      overflow-x: auto;
      gap: 48px;
      padding-bottom: 16px;
      scrollbar-width: thin;
      scrollbar-color: #1db954 #222;
    }
    .youtube-results::-webkit-scrollbar {
      height: 10px;
      background: #222;
    }
    .youtube-results::-webkit-scrollbar-thumb {
      background: #1db954;
      border-radius: 6px;
    }
    .card.youtube-card {
      background: linear-gradient(135deg, #232526 0%, #414345 100%);
      box-shadow: 0 6px 32px rgba(30,40,60,0.18);
      border-radius: 18px;
      border: 1px solid #222;
      position: relative;
      transition: transform 0.2s, box-shadow 0.2s;
      overflow: hidden;
    }
    .card.youtube-card:before {
      content: '';
      position: absolute;
      top: -40px; left: -40px;
      width: 120px; height: 120px;
      background: radial-gradient(circle, #1db95455 0%, transparent 70%);
      z-index: 0;
    }
    .card.youtube-card:hover {
      transform: translateY(-6px) scale(1.03);
      box-shadow: 0 12px 48px rgba(30,40,60,0.28);
      border-color: #1db954;
    }
    .card.youtube-card .card-body {
      padding: 24px 18px 18px 18px;
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
      z-index: 1;
    }
    .card.youtube-card h5 {
      color: #1db954;
      font-weight: 700;
      margin-bottom: 12px;
      text-align: center;
      letter-spacing: 1px;
    }
    .card.youtube-card .yt-controls {
      width: 100%;
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 10px;
      justify-content: center;
    }
    .card.youtube-card .yt-timing {
      width: 100%;
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 8px;
      justify-content: center;
    }
    .card.youtube-card .yt-player {
      width: 320px;
      height: 60px;
      background: #181818;
      border-radius: 10px;
      margin-top: 10px;
      overflow: hidden;
      box-shadow: 0 2px 12px #1db95433;
      border: 1px solid #333;
    }
    .card.youtube-card button {
      font-size: 15px;
      font-weight: 600;
      border-radius: 6px;
      padding: 6px 18px;
      box-shadow: 0 2px 8px #1db95422;
      border: none;
    }
    .card.youtube-card button:active {
      transform: scale(0.97);
    }
    .card.youtube-card input[type=range] {
      accent-color: #1db954;
    }
    .card.youtube-card .yt-icon {
      font-size: 22px;
      color: #1db954;
      margin-bottom: 8px;
    }
    @media (max-width: 900px) {
      .music-container {
        padding: 12px 4px 80px 4px;
      }
      .card-list {
        grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
        gap: 12px;
      }
      .mini-player.sticky {
        padding: 8px 8px;
      }
    }
    @media (max-width: 600px) {
      .music-container {
        padding: 4px 2px 60px 2px;
      }
      .card-list {
        grid-template-columns: 1fr;
        gap: 8px;
      }
      .mini-player.sticky {
        flex-direction: column;
        align-items: flex-start;
        padding: 6px 4px;
      }
      .mini-player img {
        width: 40px;
        height: 40px;
        margin-bottom: 8px;
      }
    }
  </style>
{% endblock %}
