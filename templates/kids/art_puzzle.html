<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Art Puzzle Game</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
</head>
<body>
<style>
  /* Hide Kids Zone header and navigation for immersive game UI */
  body {
    background: linear-gradient(135deg, #f8ffae 0%, #43c6ac 100%);
    min-height: 100vh;
    overflow-x: hidden;
    position: relative;
    margin: 0;
    padding: 0;
  }
</style>
</style>
<style>
  body {
    background: linear-gradient(135deg, #f8ffae 0%, #43c6ac 100%);
    min-height: 100vh;
    overflow-x: hidden;
    position: relative;
  }
  .animated-bg {
    position: fixed;
    top: 0; left: 0; width: 100vw; height: 100vh;
    z-index: 0;
    pointer-events: none;
    background: url('https://www.transparenttextures.com/patterns/diamond-upholstery.png'), linear-gradient(135deg, #f8ffae 0%, #43c6ac 100%);
    opacity: 0.18;
    animation: bgMove 18s linear infinite alternate;
  }
  @keyframes bgMove {
    0% { background-position: 0 0, 0 0; }
    100% { background-position: 120px 120px, 0 0; }
  }
  .art-puzzle-container {
    display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 80vh;
    z-index: 2;
    position: relative;
    background: rgba(255,255,255,0.7);
    border-radius: 32px;
    box-shadow: 0 8px 48px #43c6ac88, 0 0 0 12px #fff8dc;
    margin: 32px auto;
    padding: 32px 16px 24px 16px;
    max-width: 480px;
  }
  .art-puzzle-title {
    font-size: 2.8rem;
    color: #ff4066;
    font-weight: bold;
    margin-bottom: 18px;
    text-shadow: 2px 2px 0 #fff, 0 0 18px #43c6ac;
    font-family: 'Baloo 2', 'Comic Sans MS', cursive, sans-serif;
    letter-spacing: 2px;
    animation: popIn 1.2s cubic-bezier(.4,2,.3,1);
  }
  .art-puzzle-board {
    display: grid;
    grid-template-columns: repeat(4, 80px);
    grid-template-rows: repeat(4, 80px);
    gap: 6px;
    background: #fff8dc;
    border-radius: 18px;
    box-shadow: 0 4px 24px #43c6ac88;
    margin-bottom: 18px;
    position: relative;
  }
  .art-puzzle-piece {
    width: 80px; height: 80px;
    background-size: 320px 320px;
    border-radius: 12px;
    box-shadow: 0 2px 12px #00b8ff44;
    cursor: pointer;
    transition: box-shadow 0.2s, transform 0.2s;
    border: 2px solid #fff8dc;
    position: relative;
    animation: popIn 0.7s cubic-bezier(.4,2,.3,1);
  }
  .art-puzzle-piece.selected {
    box-shadow: 0 0 18px #ff4066;
    border: 3px solid #ff4066;
    transform: scale(1.08);
  }
  .art-puzzle-piece:active {
    transform: scale(0.96);
  }
  @keyframes popIn {
    0% { opacity: 0; transform: scale(0.7); }
    100% { opacity: 1; transform: scale(1); }
  }
  .art-puzzle-controls {
    margin-top: 18px;
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
    justify-content: center;
  }
  .art-puzzle-btn {
    font-size: 1.2rem;
    padding: 12px 28px;
    border-radius: 16px;
    background: linear-gradient(135deg, #43c6ac 0%, #f8ffae 100%);
    color: #ff4066;
    border: 2px solid #ff4066;
    font-weight: bold;
    cursor: pointer;
    margin: 0 8px;
    box-shadow: 0 2px 12px #43c6ac44;
    transition: 0.2s;
    font-family: 'Baloo 2', 'Comic Sans MS', cursive, sans-serif;
  }
  .art-puzzle-btn:hover {
    background: linear-gradient(135deg, #ff4066 0%, #f8ffae 100%);
    color: #43c6ac;
    border-color: #43c6ac;
    box-shadow: 0 4px 24px #ff406688;
  }
  .mode-select-modal, .level-select-modal {
    position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
    background: linear-gradient(135deg, #f8ffae 0%, #43c6ac 100%);
    z-index: 10000; display: flex; flex-direction: column; align-items: center; justify-content: center;
    animation: popIn 0.7s cubic-bezier(.4,2,.3,1);
  }
  .mode-select-modal h2 {
    color: #ff4066; font-size: 2.6rem; margin-bottom: 32px;
    font-family: 'Baloo 2', 'Comic Sans MS', cursive, sans-serif;
    text-shadow: 2px 2px 0 #fff, 0 0 18px #43c6ac; letter-spacing: 2px;
  }
  .mode-select-modal .mode-btns {
    display: flex; gap: 32px; flex-direction: row; justify-content: center; flex-wrap: wrap;
  }
  .mode-select-modal .mode-btn {
    font-size: 1.6rem; padding: 22px 48px; border-radius: 28px; border: none;
    font-family: 'Baloo 2', 'Comic Sans MS', cursive, sans-serif;
    box-shadow: 0 8px 32px #43c6ac88, 0 0 0 12px #fff8dc;
    cursor: pointer; transition: 0.2s; margin: 12px 0; font-weight: bold; outline: none;
    border: 4px solid #ff4066; background: linear-gradient(135deg, #fff8dc 0%, #f8ffae 100%); color: #43c6ac;
    text-shadow: 1px 1px 0 #fff, 0 0 8px #ff4066;
  }
  .mode-select-modal .mode-btn:hover {
    background: linear-gradient(135deg, #ff4066 0%, #f8ffae 100%); color: #fff; border-color: #43c6ac;
    box-shadow: 0 8px 32px #ff406688;
  }
  .level-select-modal h3 {
    color: #43c6ac; font-size: 2rem; margin-bottom: 18px; font-family: 'Baloo 2', 'Comic Sans MS', cursive, sans-serif;
  }
  .level-btns {
    display: flex; gap: 18px; flex-wrap: wrap; justify-content: center;
  }
  .level-btn {
    font-size: 1.2rem; padding: 14px 32px; border-radius: 18px; border: 3px solid #00b8ff;
    background: #fff8dc; color: #00b8ff; font-weight: bold; cursor: pointer; transition: 0.2s; margin: 8px 0;
    font-family: 'Baloo 2', 'Comic Sans MS', cursive, sans-serif;
    box-shadow: 0 2px 12px #00b8ff44;
  }
  .level-btn:hover {
    background: #43c6ac; color: #fff; border-color: #ff4066; box-shadow: 0 4px 24px #43c6ac88;
  }
  .custom-upload-box {
    margin: 24px 0; text-align: center;
    background: rgba(255,255,255,0.8);
    border-radius: 18px;
    box-shadow: 0 2px 12px #43c6ac44;
    padding: 18px 0;
  }
  .custom-upload-box input[type='file'] {
    font-size: 1.1rem; padding: 10px 18px; border-radius: 10px; border: 2px solid #43c6ac; background: #fff8dc; color: #ff4066;
    font-family: 'Baloo 2', 'Comic Sans MS', cursive, sans-serif;
  }
  .custom-upload-box .art-puzzle-btn { margin-top: 12px; }
  #artPuzzleMsg {
    margin-top: 18px; font-size: 1.4rem; color: #43c6ac; font-weight: bold; text-shadow: 1px 1px 0 #fff, 0 0 8px #43c6ac;
    min-height: 32px;
    text-align: center;
    position: relative;
  }
  .trophy {
    display: inline-block;
    width: 48px; height: 48px;
    background: url('https://cdn-icons-png.flaticon.com/512/616/616494.png') no-repeat center/contain;
    vertical-align: middle;
    margin-right: 8px;
    animation: trophyPop 1.2s cubic-bezier(.4,2,.3,1);
  }
  @keyframes trophyPop {
    0% { opacity: 0; transform: scale(0.5) rotate(-30deg); }
    80% { opacity: 1; transform: scale(1.1) rotate(10deg); }
    100% { opacity: 1; transform: scale(1) rotate(0deg); }
  }
</style>
<div class="animated-bg"></div>
<div class="animated-bg"></div>
<div id="modeSelect" class="mode-select-modal">
  <div class="mode-btns">
    <button onclick="startLevelsMode()" class="mode-btn">Levels Mode</button>
    <button onclick="startCustomMode()" class="mode-btn">Custom Mode</button>
  </div>
</div>
<div id="levelSelect" class="level-select-modal" style="display:none;">
  <h3>Select a Level</h3>
  <div id="levelBtns" class="level-btns"></div>
  <button onclick="backToModeSelect()" class="art-puzzle-btn">⬅️ Back</button>
</div>
<div id="customUploadBox" class="custom-upload-box" style="display:none;">
  <h3>Upload Your Image</h3>
  <input type="file" id="customImageInput" accept="image/png,image/jpeg">
  <button onclick="startCustomPuzzle()" class="art-puzzle-btn">Start Puzzle</button>
  <button onclick="backToModeSelect()" class="art-puzzle-btn">⬅️ Back</button>
</div>
<div class="art-puzzle-container" id="artPuzzleContainer" style="display:none;">
  <!-- Removed header for cleaner look -->
  <div id="referenceImageBox" style="margin-bottom:18px; text-align:center;">
  <span style="font-size:1.1rem;color:#43c6ac;font-weight:bold;">Reference Image:</span><br>
  <img id="referenceImage" src="" alt="Reference" style="max-width:120px;max-height:120px;border-radius:12px;box-shadow:0 2px 8px #43c6ac44;display:none;">
  </div>
  <div id="artPuzzleBoard" class="art-puzzle-board"></div>
  <div class="art-puzzle-controls">
    <button onclick="shufflePuzzle()" class="art-puzzle-btn">Shuffle</button>
    <button onclick="resetPuzzle()" class="art-puzzle-btn">Reset</button>
    <button onclick="backToModeSelect()" class="art-puzzle-btn">Back to Modes</button>
  </div>
  <div id="artPuzzleMsg" style="margin-top:18px;font-size:1.2rem;color:#43c6ac;font-weight:bold;"></div>
</div>
<script>
// --- Art Puzzle Professional Game ---
const puzzleSize = 4; // 4x4
let board = [];
let emptyIdx = puzzleSize*puzzleSize-1;
let selectedIdx = null;
let currentImgSrc = '';
let currentMode = '';
let currentLevel = 0;
let allowMoves = false;
const levelImages = [
  '/media/movies/apple-439397_640.webp',
  '/media/movies/635217f73e372771013edb4c-the-avengers-poster-marvel-movie-canvas1.jpg',
  '/media/movies/feUv2SYumXlT8E2RhzlYbZxfEGLG5AVrCPxP1gmAaCusxyPnA1.jpg',
  '/media/movies/f5VK0h2bprRhR6iRrixcuEfRxSUF4l14F66vQYrsJGmKZ5nTA1.jpg'
];
function showModeSelect() {
  document.getElementById('modeSelect').style.display = 'flex';
  document.getElementById('levelSelect').style.display = 'none';
  document.getElementById('customUploadBox').style.display = 'none';
  document.getElementById('artPuzzleContainer').style.display = 'none';
}
function startLevelsMode() {
  currentMode = 'levels';
  document.getElementById('modeSelect').style.display = 'none';
  document.getElementById('levelSelect').style.display = 'flex';
  renderLevelButtons();
}
function startCustomMode() {
  currentMode = 'custom';
  document.getElementById('modeSelect').style.display = 'none';
  document.getElementById('customUploadBox').style.display = 'block';
}
function backToModeSelect() {
  showModeSelect();
}
function renderLevelButtons() {
  const levelBtns = document.getElementById('levelBtns');
  levelBtns.innerHTML = '';
  levelImages.forEach((img, idx) => {
    const btn = document.createElement('button');
    btn.className = 'level-btn';
    btn.innerHTML = `Level ${idx+1}`;
    btn.onclick = function() { startLevel(idx); };
    levelBtns.appendChild(btn);
  });
}
function startLevel(idx) {
  currentLevel = idx;
  currentImgSrc = levelImages[idx];
  document.getElementById('levelSelect').style.display = 'none';
  document.getElementById('artPuzzleContainer').style.display = 'flex';
  // Show reference image
  const refImg = document.getElementById('referenceImage');
  refImg.src = currentImgSrc;
  refImg.style.display = 'inline-block';
  createBoard();
}
function startCustomPuzzle() {
  const input = document.getElementById('customImageInput');
  if (!input.files.length) return alert('Please select an image.');
  const file = input.files[0];
  const reader = new FileReader();
  reader.onload = function(e) {
    currentImgSrc = e.target.result;
    document.getElementById('customUploadBox').style.display = 'none';
    document.getElementById('artPuzzleContainer').style.display = 'flex';
    // Show reference image
    const refImg = document.getElementById('referenceImage');
    refImg.src = currentImgSrc;
    refImg.style.display = 'inline-block';
    createBoard();
  };
  reader.readAsDataURL(file);
}
function createBoard() {
  board = Array.from({length: puzzleSize*puzzleSize}, (_, i) => i);
  emptyIdx = puzzleSize*puzzleSize-1;
  renderBoard();
  document.getElementById('artPuzzleMsg').textContent = '';
}
function renderBoard() {
  const boardDiv = document.getElementById('artPuzzleBoard');
  boardDiv.innerHTML = '';
  board.forEach((pieceIdx, idx) => {
    const piece = document.createElement('div');
    piece.className = 'art-puzzle-piece' + (selectedIdx===idx ? ' selected' : '');
    if (pieceIdx !== puzzleSize*puzzleSize-1) {
      const x = pieceIdx % puzzleSize;
      const y = Math.floor(pieceIdx / puzzleSize);
      piece.style.backgroundImage = `url('${currentImgSrc}')`;
      piece.style.backgroundPosition = `-${x*80}px -${y*80}px`;
    } else {
      piece.style.background = '#fff8dc';
    }
    piece.onclick = () => movePiece(idx);
    boardDiv.appendChild(piece);
  });
}
function movePiece(idx) {
  if (!allowMoves) return;
  if (isAdjacent(idx, emptyIdx)) {
    [board[idx], board[emptyIdx]] = [board[emptyIdx], board[idx]];
    emptyIdx = idx;
    renderBoard();
    checkWin();
  }
}
function isAdjacent(a, b) {
  const ax = a % puzzleSize, ay = Math.floor(a/puzzleSize);
  const bx = b % puzzleSize, by = Math.floor(b/puzzleSize);
  return (Math.abs(ax-bx)+Math.abs(ay-by))===1;
}
function shufflePuzzle() {
  for(let i=0;i<100;i++) {
    const adj = [emptyIdx-1,emptyIdx+1,emptyIdx-puzzleSize,emptyIdx+puzzleSize].filter(j=>j>=0&&j<puzzleSize*puzzleSize&&isAdjacent(j,emptyIdx));
    const r = adj[Math.floor(Math.random()*adj.length)];
    if(r!==undefined) {
      // Temporarily allow moves for shuffling
      allowMoves = true;
      movePiece(r);
      allowMoves = false;
    }
  }
  document.getElementById('artPuzzleMsg').textContent = '';
  allowMoves = true;
}
function resetPuzzle() {
  createBoard();
  document.getElementById('artPuzzleMsg').textContent = '';
}
function checkWin() {
  if (board.every((v,i)=>v===i)) {
    document.getElementById('artPuzzleMsg').innerHTML = '<span class="trophy"></span> <span style="color:#ff4066;font-weight:bold;">Congratulations!</span> You solved the puzzle!';
    confettiEffect();
  }
}

// --- Confetti Effect ---
function confettiEffect() {
  for(let i=0;i<32;i++) {
    const conf = document.createElement('div');
    conf.style.position = 'fixed';
    conf.style.left = Math.random()*100+'vw';
    conf.style.top = '-32px';
    conf.style.width = '18px';
    conf.style.height = '18px';
    conf.style.borderRadius = '50%';
    conf.style.background = `hsl(${Math.random()*360},90%,60%)`;
    conf.style.zIndex = 99999;
    conf.style.opacity = 0.8;
    conf.style.pointerEvents = 'none';
    conf.style.transition = 'top 1.8s cubic-bezier(.4,2,.3,1), opacity 0.8s';
    document.body.appendChild(conf);
    setTimeout(()=>{
      conf.style.top = (60+Math.random()*30)+'vh';
      conf.style.opacity = 0;
    }, 100);
    setTimeout(()=>conf.remove(), 2000);
  }
}
window.addEventListener('DOMContentLoaded', () => {
  showModeSelect();
  allowMoves = false;
  setTimeout(() => {
    // Only shuffle if the puzzle is visible and loaded
    if (document.getElementById('artPuzzleContainer').style.display === 'flex') {
      shufflePuzzle();
    }
  }, 3000);
});
</script>
</body>
</html>
